---
# Handlers for setup_tripwire role. Only run when notified by a task

- name: Verify Tripwire integrity
  ansible.builtin.command: tripwire --check
  become: true
  register: tripwire_check
  changed_when: false
  # This task doesnâ€™t mark "changed", only verifies integrity

- name: Restart Tripwire service
  ansible.builtin.service:
    name: tripwire
    state: restarted
  become: true
  # Only runs if a task notified it due to a critical change

- name: Compile Tripwire policy
  ansible.builtin.command: tripwire --update-policy /etc/tripwire/twpol.txt
  become: true
  args:
    creates: /etc/tripwire/twpol.txt
