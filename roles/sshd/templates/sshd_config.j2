# /etc/ssh/sshd_config
# Secure SSH configuration - Audit compliant

# --------------------------------------------------
# 33157 - Ensure sshd access is configured
# --------------------------------------------------
Protocol 2
Port 22
AddressFamily any
ListenAddress 0.0.0.0
ListenAddress ::

# --------------------------------------------------
# Authentication
# --------------------------------------------------
UsePAM yes
PasswordAuthentication yes
PermitEmptyPasswords no
ChallengeResponseAuthentication no
KbdInteractiveAuthentication no

# --------------------------------------------------
# 33173 - Ensure sshd PermitRootLogin is disabled
# --------------------------------------------------
PermitRootLogin no

# --------------------------------------------------
# 33166 - Ensure sshd LoginGraceTime is configured
# --------------------------------------------------
LoginGraceTime 30

# --------------------------------------------------
# 33169 - Ensure sshd MaxAuthTries is configured
# --------------------------------------------------
MaxAuthTries 3

# --------------------------------------------------
# 33171 - Ensure sshd MaxStartups is configured
# --------------------------------------------------
MaxStartups 10:30:60

# --------------------------------------------------
# 33160 - Ensure sshd ClientAliveInterval and CountMax
# --------------------------------------------------
ClientAliveInterval 300
ClientAliveCountMax 3

# --------------------------------------------------
# 33161 - Ensure sshd DisableForwarding is enabled
# --------------------------------------------------
DisableForwarding yes
AllowTcpForwarding no
AllowAgentForwarding no
X11Forwarding no

# --------------------------------------------------
# 33158 - Ensure sshd Banner is configured
# --------------------------------------------------
Banner /etc/issue.net

# --------------------------------------------------
# 33168 - Ensure sshd MACs are configured
# --------------------------------------------------
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com

# --------------------------------------------------
# Additional hardening (safe for audits)
# --------------------------------------------------
IgnoreRhosts yes
HostbasedAuthentication no
PermitUserEnvironment no
TCPKeepAlive no
Compression no

# --------------------------------------------------
# Logging
# --------------------------------------------------
SyslogFacility AUTH
LogLevel VERBOSE
